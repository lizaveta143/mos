"use strict";(self.webpackChunkdo=self.webpackChunkdo||[]).push([[0],{1770:(t,e,i)=>{i.d(e,{k$:()=>s,N3:()=>n,jo:()=>r});var a=function(t){var e=window.getComputedStyle(t);return"none"===e.display||"hidden"===e.visibility},n=function(t){if(a(t))return!0;for(var e=t.parentElement;e;){if(a(e))return!0;e=e.parentElement}return!1},r=function(t,e){t.forEach((function(t){e.classList.contains(t)&&e.classList.remove(t)}))},o=i(7870),s=function(t){if(!o.U.test(t))throw new Error("Id is invalid: ".concat(t));return t.slice(0,o.B)}},3944:(t,e,i)=>{var a,n,r;i.d(e,{DX:()=>s,H_:()=>d,QE:()=>c,Vw:()=>a,_1:()=>f,dD:()=>p,lx:()=>h,mh:()=>r,qn:()=>o,wA:()=>l,xl:()=>u}),function(t){t.TEXT="text",t.HIDDEN="input_hidden",t.PHONE="phone",t.PASSWORD="password",t.NUMBER="number",t.EMAIL="email",t.SELECT="select",t.SELECT_MULTIPLE="select_multiple",t.CHECKBOX="checkbox",t.CHECKBOX_GROUP="checkbox_group",t.RADIO_GROUP="radio_group",t.TEXTAREA="textarea",t.UPLOAD_FILE="upload_file",t.DATE="date",t.DATE_INTERVAL="date_interval"}(a||(a={})),function(t){t.OLD="data-do-form",t.NEW="data-do-tt_form"}(n||(n={})),function(t){t.FORM="form",t.CAPTCHA='[data-name="captcha"]',t.INPUT_AND_TEXTAREA="textarea, input",t.INPUT_AND_SELECT_AND_TEXTAREA="input,select,textarea",t.INPUT_FIRST="input:first",t.INPUT_DATA_DO="data-do-mask",t.INPUT_MASK="input-mask",t.INPUT="input",t.TEXTAREA_FIRST="textarea:first",t.CHECKBOX_CHECKED=":checkbox:checked",t.CHECKBOX_CHECKED_FIRST=":checkbox:checked:first",t.SELECT_FIRST="select:first",t.SELECT_OPTION_SELECTED="select option:selected",t.RADIO_CHECKED_FIRST=":radio:checked:first",t.CAPTCHA_FORM_INPUT=":input",t.CAPTCHA_FORM=".visible-captcha form",t.CAPTCHA_FORM_RECAPTCHA='[data-name="captcha-page"]',t.INVISIBLE_CAPTCHA='[data-field-position="captcha"]',t.VISIBLE_CAPTCHA=".visible-captcha"}(r||(r={}));var o={SUCCESS_CONTAINER:".form__state-success",ERROR_CONTAINER:".form__state-error",FIELD:".form__field",FIELD_ERROR:".form__field-error",FIELD_ERROR_TEXT:".form__field-error .text-block-wrap-div",FIELD_CAPTCHA:".tt-form__field--captcha",FIELD_DATE:'.form__field[data-type-field="date"]',FIELD_DATE_INTERVAL:'.form__field[data-type-field="date_interval"]',SUBMIT_BUTTON:".button",INPUT_DATE_INTERVAL:"input.tt-form__date-interval",UPLOAD_FIELD:'.form__field[data-type-field="upload_file"]',UPLOAD_FIELD_PROGRESS_STATUS:".progressBarStatus",UPLOAD_FIELD_FILE_PLACEHOLDER:".upload-file__input",UPLOAD_FIELD_FILE_HIDDEN_INPUT:".upload-input",UPLOAD_FIELD_PROGRESS:".upload-list",UPLOAD_FIELD_FILES_CONTAINER:".upload-items",UPLOAD_FIELD_FILES_ITEM:".upload-item",UPLOAD_FIELD_FILES_ITEM_NAME:".upload-item__name",UPLOAD_FIELD_FILES_ITEM_SIZE:".upload-item__size",UPLOAD_FIELD_FILES_ITEM_REMOVE:".upload-item__remove"},s="yy-mm-dd",l="is-removed",c="is-error",d="is-opened",u="is-uploading",h="is-success",f="c-80:c+10",p=["ru","en"]},4929:(t,e,i)=>{i.r(e),i.d(e,{default:()=>D});var a=i(8610),n=i(1770),r=i(8171),o=i(7870),s=Object.defineProperty,l=(t,e,i)=>((t,e,i)=>e in t?s(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i)(t,"symbol"!=typeof e?e+"":e,i),c=(t=>(t.PENDING="pending",t.SUCCESS="success",t.ERROR="error",t))(c||{});const d={maxFileLimitReached:"Maximum file limit reached",fileSizeExceeds:t=>`File size exceeds ${t} MB`,noFilesSelected:"No files selected for required upload",queued:"Queued",uploading:"Uploading",complete:"Complete",removed:"Removed",httpError:t=>t?`HTTP Error (${t})`:"HTTP Error (Unknown status)",responseParseError:"Response Parse Error",requestError:"Request Error"};class u{constructor(t){var e;l(this,"url"),l(this,"fileDataName"),l(this,"uploadId"),l(this,"isIceBox"),l(this,"required"),l(this,"maxFiles"),l(this,"maxSize"),l(this,"headers"),l(this,"files",[]),l(this,"uploadedFiles",[]),l(this,"filesUpload",0),l(this,"iceBoxToken"),l(this,"formSubmitEvents"),l(this,"error",!1),l(this,"uploadSuccessful",!0),l(this,"localization"),l(this,"onInit"),l(this,"onCompleteAll"),l(this,"onProgress"),l(this,"onStatusChange"),this.uploadId=t.uploadId,this.required=t.required,this.maxFiles=t.maxFiles,this.maxSize=t.maxSize,this.fileDataName=t.fileDataName,this.formSubmitEvents=!1,this.onInit=t.onInit,this.onCompleteAll=t.onCompleteAll,this.onProgress=t.onProgress,this.onStatusChange=t.onStatusChange,this.localization=t.localization??d;const{url:i,headers:a,token:n}=this.parseUrl(t.url);this.url=i,this.headers=a,this.iceBoxToken=n,this.isIceBox=!!a,null==(e=this.onInit)||e.call(this,this)}parseUrl(t){if(!function(t){try{return JSON.parse(t),!0}catch{return!1}}(t))return{url:t,headers:void 0,token:void 0};const{upload_url:e,upload_token:i}=JSON.parse(t);return{headers:null!=i&&i.length?{Authorization:`bearer ${i}`}:void 0,url:e,token:i}}addFiles(t){var e,i,a;for(const n of t){if(this.files.length>=this.maxFiles){null==(e=this.onStatusChange)||e.call(this,this.randomUUID(),this.localization.maxFileLimitReached,c.ERROR),this.error=!0;continue}if(this.convertSize(n.size)>this.maxSize){null==(i=this.onStatusChange)||i.call(this,this.randomUUID(),this.localization.fileSizeExceeds(this.maxSize),c.ERROR),this.error=!0;continue}const t={file:n,id:this.randomUUID(),index:this.files.length};this.files.push(t),this.filesUpload++,null==(a=this.onStatusChange)||a.call(this,t.id,this.localization.queued,c.PENDING)}}start(){var t;if(this.required&&0===this.files.length)return this.error=!0,void(null==(t=this.onStatusChange)||t.call(this,this.randomUUID(),this.localization.noFilesSelected,c.ERROR));this.error=!1,this.uploadSuccessful=!0,this.upload(0)}getFiles(){return this.files}getUploadedFiles(){return this.uploadedFiles}clearFiles(){this.files=[],this.uploadedFiles=[],this.filesUpload=0,this.error=!1,this.uploadSuccessful=!0}deleteFile(t){var e;this.files.find((e=>e.id===t))&&(this.files=this.files.filter((e=>e.id!==t)),this.filesUpload--,null==(e=this.onStatusChange)||e.call(this,t,this.localization.removed,void 0))}destroy(){this.clearFiles(),this.onInit=void 0,this.onCompleteAll=void 0,this.onProgress=void 0,this.onStatusChange=void 0}upload(t){var e,i;const a=this.files[t];a?(a.onComplete=(t,e,i)=>{var n,r,o;if(this.filesUpload--,!t)return this.uploadSuccessful=!1,this.error=!0,null==(n=this.onStatusChange)||n.call(this,a.id,this.localization.httpError(i),c.ERROR),void this.upload(a.index+1);let s=null;try{s=this.isIceBox?JSON.parse(e).result:JSON.parse(e)[0]}catch(t){return console.error(this.localization.requestError,t),null==(r=this.onStatusChange)||r.call(this,a.id,this.localization.responseParseError,c.ERROR),void this.upload(a.index+1)}s&&(this.uploadedFiles.push({url:s.filename[0],filename:s.filename[1]}),null==(o=this.onStatusChange)||o.call(this,a.id,this.localization.complete,c.SUCCESS)),this.upload(a.index+1)},null==(i=this.onStatusChange)||i.call(this,a.id,this.localization.uploading,c.PENDING),this.uploadItem(a)):this.uploadedFiles.length===this.files.length&&!this.error&&(null==(e=this.onCompleteAll)||e.call(this,this.uploadedFiles,this.iceBoxToken))}uploadItem(t){var e;if(!(t.file instanceof File))return void(null==(e=t.onComplete)||e.call(t,!1,"",0));const i=new XMLHttpRequest;i.upload&&i.upload.addEventListener("progress",(e=>{var i;e.lengthComputable&&(null==(i=this.onProgress)||i.call(this,t.id,e.loaded,e.total))})),i.onreadystatechange=e=>{var i,a,n;const r=e.currentTarget;if(4===r.readyState)try{r.status>=200&&r.status<400?null==(i=t.onComplete)||i.call(t,!0,r.responseText):null==(a=t.onComplete)||a.call(t,!1,"",r.status)}catch(e){console.error(this.localization.requestError,e),null==(n=t.onComplete)||n.call(t,!1,"",0)}},i.open("POST",this.url);const a=new FormData;a.set("name",t.file.name),a.append(this.isIceBox?this.fileDataName:"files",t.file),this.headers&&Object.entries(this.headers).forEach((([t,e])=>{i.setRequestHeader(t,e)})),i.send(a)}convertSize(t,e=2){const i=Math.max(0,e);return parseFloat((t/Math.pow(1024,2)).toFixed(i))}randomUUID(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(t=>{const e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)}))}}var h=i(3944),f=".ai, .csv, .doc, .docx, .indd, .key, .numbers, .pps, .ppt, .pptx, .psd, .ods, .odt, .pages, .pdf, .txt, .xls, .xlsx, .odp",p=".bmp, .dng, .eps, .gif, .jpg, .jpeg, .png, .ps, .raw, .svg, .tga, .tif, .tiff, .webp",m=".swf, .flv, .mp4, .mkv, .h264, .m4v, .mpeg4, .mpg, .avi, .ogg, .ogv, .wav, .3gp, .mid, .webm, .vob, .drc, .mng, .mov, .qt, .wmv, .yuv, .rm, .rmvb, .asf, .amv, .mp2, .mpeg, .mpe, .mpv, .m2v, .svi, .3g2, .mxf, .roq, .nsv, .f4v, .f4p, .f4a, .f4b",v=".m4a, .mid, .mp3, .mpa, .ogg, .wav, .wma",E=[".php",".cphp",".cgi",".sh"],_=1e3,C=1e6,g={en:"Failed to upload the file. Maximum single file size: 15 MB",ru:"Не удалось загрузить файл. Максимальный размер файла 15Мб"},I="File uploading is unavailable",x={en:"This file format is not allowed for uploading",ru:"Этот формат файла не допускается для загрузки"},A=function(t,e,i,a){return new(i||(i=Promise))((function(n,r){function o(t){try{l(a.next(t))}catch(t){r(t)}}function s(t){try{l(a.throw(t))}catch(t){r(t)}}function l(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,s)}l((a=a.apply(t,e||[])).next())}))},S=function(t,e){var i,a,n,r,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(l){return function(s){if(i)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(o=0)),o;)try{if(i=1,a&&(n=2&s[0]?a.return:s[0]?a.throw||((n=a.return)&&n.call(a),0):a.next)&&!(n=n.call(a,s[1])).done)return n;switch(a=0,n&&(s=[2&s[0],n.value]),s[0]){case 0:case 1:n=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,a=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(n=o.trys,(n=n.length>0&&n[n.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!n||s[1]>n[0]&&s[1]<n[3])){o.label=s[1];break}if(6===s[0]&&o.label<n[1]){o.label=n[1],n=s;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(s);break}n[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(t){s=[6,t],a=0}finally{i=n=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},T=function(t,e,i){if(i||2===arguments.length)for(var a,n=0,r=e.length;n<r;n++)!a&&n in e||(a||(a=Array.prototype.slice.call(e,0,n)),a[n]=e[n]);return t.concat(a||Array.prototype.slice.call(e))},w=function(){function t(e,i,r){var o=this;this.uploaderInstances=new Map,this.classesMap=new Map,this.uploadConfigMap=new Map,this.initializeUploader=function(e,i,r){return A(o,void 0,void 0,(function(){var o,s,l,c,d,u,f;return S(this,(function(p){return e.classList.contains(h.QE)&&e.classList.remove(h.QE),e.classList.contains(h.lx)&&e.classList.remove(h.lx),o=(0,n.k$)(e.id),s=i.data.tt_form_upload_file[o],l=r(i.params[s]),c=l(a.$U.SCREEN),d=e.querySelector(h.qn.UPLOAD_FIELD_FILE_PLACEHOLDER),t.configureInputFile(d,c),(u=this.uploadConfigMap.get(e.id))?(f=this.createUploader(e.id,d,c,u.upload_url),this.collectClassMap(e),this.uploaderInstances.set(e.id,f),[2]):[2]}))}))},this.formContainer=e,this.lang=i,this.anketaId=r}return t.prototype.init=function(){return A(this,void 0,void 0,(function(){var t,e,r,o,s,l,c,d,u,f=this;return S(this,(function(p){switch(p.label){case 0:return this.anketaId&&(t=null===(u=document.getElementById("data_do_json"))||void 0===u?void 0:u.textContent)?(e=this.formContainer.querySelectorAll(h.qn.UPLOAD_FIELD),r=JSON.parse(t),[4,i.e(122).then(i.bind(i,1239))]):[2];case 1:if(o=p.sent().default,s=[],l=[],Array.from(e).forEach((function(t){var e=(0,n.k$)(t.id),i=r.data.tt_form_upload_file[e],c=o(r.params[i])(a.$U.SCREEN),d=(null==c?void 0:c.dictionary_id)||0;d&&(s.push({tag_id:t.id,dictionary_id:d}),l.push(t))})),!s.length)return[2];p.label=2;case 2:return p.trys.push([2,4,,5]),[4,this.fetchUploadConfigs(s)];case 3:return c=p.sent(),Object.entries(c).forEach((function(t){var e=t[0],i=t[1];f.uploadConfigMap.set(e,{upload_url:i.upload_url})})),[3,5];case 4:return d=p.sent(),console.error("Ошибка при получении конфигурации загрузки:",d),[2];case 5:return[4,Promise.all(l.map((function(t){return f.initializeUploader(t,r,o)})))];case 6:return p.sent(),[2]}}))}))},t.prototype.fetchUploadConfigs=function(t){return A(this,void 0,void 0,(function(){var e;return S(this,(function(i){switch(i.label){case 0:return[4,fetch("/-/x-api/v1/public/?method=mosaic/anketaGetUploadData&param[form_id]=".concat(this.anketaId),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({upload_fields:t})})];case 1:if(!(e=i.sent()).ok)throw new Error("Ошибка API: ".concat(e.status));return[4,e.json()];case 2:return[2,i.sent().result]}}))}))},t.configureInputFile=function(t,e){var i={Video:m,Images:p,Audio:v,Documents:f,Custom:e.custom_file_types};t.accept=i[e.file_types]||"",t.multiple=Boolean(e.multiple)},t.prototype.createUploader=function(e,i,a,n){var r=this;return new u({uploadId:e,url:n,required:!0,maxFiles:a.multiple?30:1,maxSize:15,fileDataName:"file",isIceBox:!0,onInit:function(t){return r.onInitFileInput(t,i)},onStatusChange:t.onStatusChange})},t.prototype.collectClassMap=function(t){var e={};t.querySelectorAll("*").forEach((function(t){if(t instanceof HTMLElement){var i=t.className.split(" ")[0];e[i]=t.className}})),this.classesMap.set(t.id,e)},t.prototype.onInitFileInput=function(e,i){var a=this;i.addEventListener("change",(function(n){var r=n.target.files;if(null==r?void 0:r.length){var o=Array.from(r).filter((function(e){var n=t.bytesToMb(e.size),r=e.name.slice(e.name.lastIndexOf(".")).toLowerCase();return n>15?(t.showError(i.id,g[a.lang]),!1):!E.includes(r)||(t.showError(i.id,x[a.lang]),!1)}));o.length&&(e.addFiles(o),a.renderFileList(e.getFiles(),e),e.start(),i.value="")}}))},t.prototype.renderFileList=function(t,e){var i=this,a=document.getElementById(e.uploadId),n=null==a?void 0:a.querySelector(".upload-items"),r=null==a?void 0:a.querySelector(".upload-file");if(n&&n.parentElement&&r){var o=e.maxFiles<=t.length;r.style.display=o?"none":"inline-flex",n.parentElement.style.display=t.length?"block":"none",n.innerHTML="",t.forEach((function(t){n.appendChild(i.createFileNode(t,e))}))}},t.prototype.createFileNode=function(e,i){var a,n=this.classesMap.get(i.uploadId),r=document.createElement("div");r.id=e.id,(a=r.classList).add.apply(a,T(T([],n["upload-item"].split(" "),!1),[h.H_],!1));var o=t.formatFileSize(e.file.size);return r.appendChild(t.createElement("div",n["upload-item__name"],e.file.name)),r.appendChild(t.createElement("div",n["upload-item__size"],o)),r.appendChild(this.createRemoveLink(e,i)),r},t.createElement=function(t,e,i){var a,n=document.createElement(t);return(a=n.classList).add.apply(a,e.split(" ")),n.textContent=i,n},t.prototype.createRemoveLink=function(e,i){var a,n=this,r=this.classesMap.get(i.uploadId),o=document.createElement("span");return(a=o.classList).add.apply(a,r["upload-item__remove"].split(" ")),o.id=t.randomUUID(),o.addEventListener("click",(function(t){t.preventDefault(),i.deleteFile(e.id),i.uploadedFiles=i.uploadedFiles.filter((function(t){return t.filename!==e.file.name})),n.renderFileList(i.getFiles(),i)})),o},t.bytesToMb=function(t,e){return void 0===e&&(e=2),Number((t/C).toFixed(e))},t.bytesToKb=function(t,e){return void 0===e&&(e=2),Number((t/_).toFixed(e))},t.formatFileSize=function(e){var i=t.bytesToMb(e);return i>=1?"".concat(i," mb"):"".concat(t.bytesToKb(e)," kb")},t.toggleUploadingClass=function(t,e){var i,a=document.getElementById(t),n=null===(i=document.getElementById(t))||void 0===i?void 0:i.closest(h.qn.FIELD),r=null==a?void 0:a.querySelector(h.qn.UPLOAD_FIELD_FILES_ITEM_REMOVE);e?null==r||r.classList.add(h.xl):(null==n||n.classList.add(h.lx),null==r||r.classList.remove(h.xl))},t.showError=function(t,e){var i,a=null===(i=document.getElementById(t))||void 0===i?void 0:i.closest(h.qn.FIELD),n=null==a?void 0:a.querySelector(h.qn.FIELD_ERROR_TEXT);null==a||a.classList.add(h.QE),n&&(n.innerHTML=null!=e?e:I)},t.prototype.getUploaderInstance=function(t){return this.uploaderInstances.get(t)},t.randomUUID=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)}))},t.onStatusChange=function(e,i,a){if(a===c.PENDING&&t.toggleUploadingClass(e,!0),a===c.SUCCESS&&t.toggleUploadingClass(e,!1),a===c.ERROR){t.showError(e);var n=document.getElementById(e);n&&n.remove()}},t}(),b=function(t,e,i,a){return new(i||(i=Promise))((function(n,r){function o(t){try{l(a.next(t))}catch(t){r(t)}}function s(t){try{l(a.throw(t))}catch(t){r(t)}}function l(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,s)}l((a=a.apply(t,e||[])).next())}))},y=function(t,e){var i,a,n,r,o={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(s){return function(l){return function(s){if(i)throw new TypeError("Generator is already executing.");for(;r&&(r=0,s[0]&&(o=0)),o;)try{if(i=1,a&&(n=2&s[0]?a.return:s[0]?a.throw||((n=a.return)&&n.call(a),0):a.next)&&!(n=n.call(a,s[1])).done)return n;switch(a=0,n&&(s=[2&s[0],n.value]),s[0]){case 0:case 1:n=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,a=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(n=o.trys,(n=n.length>0&&n[n.length-1])||6!==s[0]&&2!==s[0])){o=0;continue}if(3===s[0]&&(!n||s[1]>n[0]&&s[1]<n[3])){o.label=s[1];break}if(6===s[0]&&o.label<n[1]){o.label=n[1],n=s;break}if(n&&o.label<n[2]){o.label=n[2],o.ops.push(s);break}n[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(t){s=[6,t],a=0}finally{i=n=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,l])}}},L=function(t,e,i){if(i||2===arguments.length)for(var a,n=0,r=e.length;n<r;n++)!a&&n in e||(a||(a=Array.prototype.slice.call(e,0,n)),a[n]=e[n]);return t.concat(a||Array.prototype.slice.call(e))};function D(t,e){return b(this,void 0,void 0,(function(){var s,l,c,d,u,f,p,m,v,E;return y(this,(function(_){switch(_.label){case 0:return s=window,[4,i.e(881).then(i.t.bind(i,4692,23))];case 1:return l=_.sent().default,[4,i.e(122).then(i.bind(i,1239))];case 2:return c=_.sent().default,d=c(e),u=h.qn,f=(null===(E=s._s3Lang)||void 0===E?void 0:E.code)||"ru",p=h.dD.includes(f)?f:"en",m={formParams:{},anketaId:0,formContainer:l,form:l,formSuccess:l,formError:l,formFieldContainers:l,formErrorContainers:l,gCaptcha:l,gCaptchaInitAttempts:1,gCaptchaInitAttemptsLimit:5,gCaptchaInitAttemptsTimeout:100,invisibleCaptchaLoaded:!1,uploaderManager:null,formApiUrl:"",__construct:function(t){this.formParams=d(a.$U.SCREEN),this.formContainer=l(t),this.form=this.formContainer.find(h.mh.FORM),this.anketaId=this.formParams.anketa_id||0,this.formSuccess=this.formContainer.find(u.SUCCESS_CONTAINER),this.formError=this.formContainer.find(u.ERROR_CONTAINER),this.formFieldContainers=this.formContainer.find(u.FIELD),this.formErrorContainers=this.formContainer.find(u.FIELD_ERROR),this.gCaptcha=this.formContainer.find(h.mh.CAPTCHA);var e=this.formContainer[0].classList;e.contains(h.lx)&&this.formContainer.removeClass(h.lx),e.contains(h.QE)&&this.formContainer.removeClass(h.QE),this.formFieldContainers.removeClass(h.QE),(0,n.jo)([h.lx,h.QE],t),this.formFieldContainers.removeClass(h.QE),this.uploaderManager=new w(this.form[0],p,this.anketaId),this.gCaptcha&&"invisible"!==this.gCaptcha.data("rsize")&&this.formContainer.find(h.mh.INVISIBLE_CAPTCHA).removeClass("is-invisible")},initForm:function(t){var e,i=this;this.__construct(t),this.formApiUrl="/-/x-api/v1/public/?method=form/postform&param[form_id]=".concat(this.anketaId),null===(e=this.uploaderManager)||void 0===e||e.init(),this.dateInputInit(),this.dateIntervalInputInit(),this.initMask(),this.formSubmitHandle(),(0,r.mo)()&&new r.EB(this.formContainer.get(0),this.sendForm.bind(this)).start(),this.gCaptcha&&"invisible"===this.gCaptcha.data("rsize")&&this.form.find(h.mh.INPUT_AND_SELECT_AND_TEXTAREA).on("focus",(function(){i.invisibleCaptchaLoaded?i.showCaptchaBadge():i.initInvisibleCaptcha()})).on("focusout",(function(){i.hideCaptchaBadge()}))},initCaptchaForm:function(t){var e=this,i=t.split("\x3c!--includeForm--\x3e");if(3===i.length){var a=i[1];if(a){var n=this.form.attr("class");this.form.addClass(h.wA),this.formContainer.append('<div class="visible-captcha">'.concat(a,"</div>"));var o=this.formContainer.find(h.mh.CAPTCHA_FORM);o&&(o.removeAttr("method"),o.addClass(n).removeClass(h.wA),setTimeout((function(){if(s.grecaptcha){var t=o.find(h.mh.CAPTCHA_FORM_RECAPTCHA),i=s.grecaptcha;if(i&&i.render&&!t.data(r.y5)){t.data("callback",(function(){e.sendCaptchaForm(o)}));var a=t.data();a.size=t.data("rsize"),t.data(r.y5,i.render(t.get(0),a))}}}),500))}}},formValidator:function(){var t=!1,e=this.formParams.initial_state;if(e){var i=this.getSerializeValuesForm();e=JSON.parse(e),this.formFieldContainers.each((function(a,n){var r=n.id.split("_")[0],o=e.dictionaries[r];if(o){var s="d[".concat(n.dataset.fieldPosition,"]"),c=i[s],d=l(n);o.required&&(c&&0!==c.length?d.removeClass(h.QE):(d.addClass(h.QE),t=!0))}}))}return t},sendForm:function(){var t=this;if(this.anketaId){var e=this.getSerializeValuesForm();l.post(this.formApiUrl,e,(function(e){t.formContainer.find(h.mh.VISIBLE_CAPTCHA).remove(),t.formResult(e),t.hideCaptchaBadge()}))}},sendCaptchaForm:function(t){var e=this,i={};return t.find(h.mh.CAPTCHA_FORM_INPUT).each((function(t,e){var a=l(e),n=a.attr("name");n&&(i[n]=a.val())})),l.post(this.formApiUrl,i,(function(t){t.result&&t.result.success&&(e.onFormSuccess(t),e.form.removeClass(h.wA),e.formContainer.find(h.mh.VISIBLE_CAPTCHA).remove())})),!1},initInvisibleCaptcha:function(){var t=this;if("$ite"in s){var e=s.$ite;if((null==e?void 0:e.captcha.status.recaptcha)!==r.XQ.STATUS_LOADED)this.gCaptchaInitAttempts<this.gCaptchaInitAttemptsLimit&&(this.gCaptchaInitAttempts+=1,setTimeout((function(){t.initInvisibleCaptcha()}),this.gCaptchaInitAttemptsTimeout));else if(null==s?void 0:s.grecaptcha){var i=this.gCaptcha,a=s.grecaptcha;if(a&&a.render&&!i.data(r.y5)){i.data("callback",(function(){t.sendForm()}));var n=i.data();n.size=i.data("rsize"),i.data(r.y5,a.render(i.get(0),n)),this.invisibleCaptchaLoaded=!0,this.showCaptchaBadge()}}}},formSubmitHandle:function(){var t=this;this.form.submit((function(e){t.formValidator()||setTimeout((function(){var e=t.gCaptcha;e&&"invisible"===e.data("rsize")&&s.grecaptcha&&t.invisibleCaptchaLoaded?s.grecaptcha.execute(e.data(r.y5)):t.sendForm()}),50),e.preventDefault()}))},onFormSuccess:function(t){if(t.result&&t.result.success){this.formParams.showTitleAfterSend?this.form.children().filter((function(t,e){return!e.classList.contains("mosaic-form__title")})).each((function(t,e){return e.classList.add(h.wA)})):this.form.children().addClass(h.wA),this.formContainer.addClass(h.lx),this.form.attr("data-success",!0),this.form[0].dispatchEvent(new Event("formSuccess"));var e=this.formParams.redirectAction;t.result.redirect_url?window.location.href=t.result.redirect_url:e&&("page"===e?window.location.href=this.formParams.redirectPage:"link"===e&&(window.location.href=this.formParams.redirectLink))}},onFormError:function(){this.formError&&this.formContainer.addClass(h.QE)},formResult:function(t){if(this.formFieldContainers.removeClass(h.QE),t.result&&t.result.success)this.onFormSuccess(t);else if(t.result&&t.result.error){if(t.result.html)this.initCaptchaForm(t.result.html);else if(t.result.error_fields){var e=t.result.error_fields;for(var i in e)if(i in e){var a=this.formContainer.find('[data-field-position="'.concat(i,'"]'));if("captcha"!==i)a.find(u.FIELD_ERROR_TEXT).text(e[i]);a.addClass(h.QE)}}}else t.error&&this.onFormError()},getSerializeValuesForm:function(){var t=this,e={form_id:this.anketaId};this.form.find(u.FIELD).each((function(i,a){var n,r=l(a);if(r.data("type-field")){var o="d[".concat(r.data("field-position"),"]"),s=r.data("type-field").toLowerCase();if(s===h.Vw.TEXT||s===h.Vw.PHONE||s===h.Vw.EMAIL||s===h.Vw.NUMBER||s===h.Vw.PASSWORD||s===h.Vw.HIDDEN||s===h.Vw.DATE)e[o]=r.find(h.mh.INPUT_FIRST).val();else if(s===h.Vw.TEXTAREA)e[o]=r.find(h.mh.TEXTAREA_FIRST).val();else if(s===h.Vw.CHECKBOX)e[o]=r.find(h.mh.CHECKBOX_CHECKED_FIRST).val();else if(s===h.Vw.SELECT)e[o]=r.find(h.mh.SELECT_FIRST).val();else if(s===h.Vw.RADIO_GROUP)e[o]=r.find(h.mh.RADIO_CHECKED_FIRST).val();else if(s===h.Vw.CHECKBOX_GROUP){var c=r.find(h.mh.CHECKBOX_CHECKED);e[o]=[],c.each((function(t,i){e[o].push(l(i).val())}))}else if(s===h.Vw.SELECT_MULTIPLE){var d=r.find(h.mh.SELECT_OPTION_SELECTED);e[o]=[],d.each((function(t,i){e[o].push(l(i).text())}))}else if(s===h.Vw.UPLOAD_FILE){var f=null===(n=t.uploaderManager)||void 0===n?void 0:n.getUploaderInstance(r.attr("id"));e[o]="",(null==f?void 0:f.uploadedFiles.length)&&(e[o]=JSON.stringify(L([],f.uploadedFiles,!0)),e.token=f.iceBoxToken)}else if(s===h.Vw.DATE_INTERVAL){var p=r.find(u.INPUT_DATE_INTERVAL),m=p.eq(0),v=p.eq(1),E=void 0,_=void 0;try{E=l.datepicker.formatDate(h.DX,m.datepicker("getDate")),_=l.datepicker.formatDate(h.DX,v.datepicker("getDate"))}catch(t){console.warn(t)}E&&_&&(e[o]="".concat(E," - ").concat(_))}}}));var i=this.form.find(u.FIELD_CAPTCHA);!i[0]&&this.gCaptcha[0]&&(i=this.gCaptcha),i[0]&&i.find(h.mh.INPUT_AND_TEXTAREA).each((function(t,i){var a=l(i),n=a.attr("name");n&&(e[n]=a.val())}));var a=this.form.find('[name="smart-token"]');return a[0]&&(e[a.attr("name")]=a.val()),e},dateInputInit:function(){return b(this,void 0,void 0,(function(){var t,e;return y(this,(function(a){switch(a.label){case 0:return(t=this.formContainer.find(u.FIELD_DATE)).length?[4,Promise.all([i.e(881),i.e(329)]).then(i.bind(i,5486))]:[3,7];case 1:return a.sent(),[4,Promise.all([i.e(881),i.e(329)]).then(i.t.bind(i,3747,23))];case 2:return a.sent(),e=void 0,"ru"!==p?[3,4]:[4,i.e(725).then(i.t.bind(i,9617,23))];case 3:return e=a.sent(),[3,6];case 4:return[4,i.e(275).then(i.t.bind(i,1799,23))];case 5:e=a.sent(),a.label=6;case 6:e.default(l),l.extend(l.datepicker,{_checkOffset:function(t,e,i){var a=t.dpDiv.outerWidth(),n=t.dpDiv.outerHeight(),r=t.input?t.input[0].offsetWidth:0,o=t.input?t.input[0].offsetHeight:0,s=document.documentElement.clientWidth+(i?0:l(document).scrollLeft()||0),c=document.documentElement.clientHeight+(i?0:l(document).scrollTop()||0);e.left-=this._get(t,"isRTL")?a-r:0;var d=t.input.offset().left||0;e.left-=i&&e.left===d&&l(document).scrollLeft()||0;var u=t.input.offset().top||0;return e.top-=i&&e.top===u+o&&l(document).scrollTop()||0,e.left-=Math.min(e.left,e.left+a>s&&s>a?Math.abs(e.left+a-s):0),e.top-=Math.min(e.top,e.top+n>c&&c>n?Math.abs(n+o):0),e}}),t.each((function(t,e){var i=l(e).find("input:first");i.attr("readonly","").datepicker({changeMonth:!0,changeYear:!0,yearRange:h._1,DATE_FORMAT:h.DX,beforeShow:function(){l("#ui-datepicker-div-mosaic").data("input-id",i.attr("id")||"")}})})),a.label=7;case 7:return[2]}}))}))},dateIntervalInputInit:function(){return b(this,void 0,void 0,(function(){function t(t){var e;try{e=l.datepicker.parseDate(h.DX,t.value)}catch(t){e=null}return e}var e,a;return y(this,(function(n){switch(n.label){case 0:return(e=this.formContainer.find(u.FIELD_DATE_INTERVAL)).length?[4,Promise.all([i.e(881),i.e(329)]).then(i.bind(i,5486))]:[3,7];case 1:return n.sent(),[4,Promise.all([i.e(881),i.e(329)]).then(i.t.bind(i,3747,23))];case 2:return n.sent(),a=void 0,"ru"!==p?[3,4]:[4,i.e(725).then(i.t.bind(i,9617,23))];case 3:return a=n.sent(),[3,6];case 4:return[4,i.e(275).then(i.t.bind(i,1799,23))];case 5:a=n.sent(),n.label=6;case 6:a.default(l),e.each((function(e,i){var a=l(i).find("input.mosaic-form__date-interval").eq(0),n=l(i).find("input.mosaic-form__date-interval").eq(1);a&&n&&(a.attr("readonly","").datepicker({changeMonth:!0,changeYear:!0,yearRange:h._1,DATE_FORMAT:h.DX,beforeShow:function(){l("#ui-datepicker-div-mosaic").data("input-id",a.attr("id")||"")}}).on("change",(function(){n.datepicker("option","minDate",t(a.get(0)))})),n.attr("readonly","").datepicker({changeMonth:!0,changeYear:!0,yearRange:h._1,DATE_FORMAT:h.DX,beforeShow:function(){l("#ui-datepicker-div-mosaic").data("input-id",n.attr("id")||"")}}).on("change",(function(){a.datepicker("option","maxDate",t(n.get(0)))})))})),n.label=7;case 7:return[2]}}))}))},initMask:function(){return b(this,void 0,void 0,(function(){var t,e;return y(this,(function(a){switch(a.label){case 0:return t=document.getElementById("data_do_json"),(e=this.formContainer.find(h.mh.INPUT)).length?[4,Promise.all([i.e(881),i.e(267)]).then(i.t.bind(i,7057,23))]:[3,2];case 1:a.sent(),e.each((function(e,i){var a="";if(t){var n=i.id.slice(0,o.B),r=t.textContent?JSON.parse(t.textContent):null,s=r.data[h.mh.INPUT_MASK],c=s&&s[n];c&&(a=r.params[c])}else i.hasAttribute(h.mh.INPUT_DATA_DO)&&(a=l(i).attr(h.mh.INPUT_DATA_DO)||"");a&&l(i).inputmask(a.replace(/9/g,"\\9").replace(/_/g,"9"))})),a.label=2;case 2:return[2]}}))}))},showCaptchaBadge:function(){l("#".concat(r.$g)).css("visibility","visible")},hideCaptchaBadge:function(){l("#".concat(r.$g)).css("visibility","hidden")}},void 0===window.mosaicS3Form&&(window.mosaicS3Form={}),(v=d(a.$U.SCREEN).anketa_id)&&(window.mosaicS3Form[v]=m),m.initForm(t),[2]}}))}))}},7870:(t,e,i)=>{i.d(e,{B:()=>a,U:()=>n});var a=9,n=new RegExp("^[a-z0-9]{".concat(a,"}_\\d+$"))},8171:(t,e,i)=>{i.d(e,{y5:()=>n,$g:()=>a,XQ:()=>r,EB:()=>s,mo:()=>l});var a="badge-captcha",n="captcha-widget-id",r={STATUS_NOT_LOADED:0,STATUS_LOADING:1,STATUS_LOADED:2},o="smart_captcha";const s=function(){function t(t,e){var i;this.widget=t,this.send=e,this.lang=(null===(i=window.params)||void 0===i?void 0:i.lang)||"ru",this.unsubscribe=null,this.sendCaptcha=this.execute.bind(this),this.form=t.querySelector("form")}return t.prototype.load=function(){var t=document.createElement("script");t.src="https://smartcaptcha.yandexcloud.net/captcha.js?onload=onSmartCaptchaLoad&render=onload&hl=".concat(this.lang),t.type="text/javascript",t.async=!0,document.head.appendChild(t)},t.prototype.checker=function(){var t=this.widget.querySelector('smart-captcha, [data-name="captcha-page"]');if(t&&!$(t).data("captcha-init")){this.addCaptcha({sitekey:t.getAttribute("data-sitekey"),type:t.getAttribute("data-type"),rsize:t.getAttribute("data-rsize"),theme:t.getAttribute("data-theme"),lang:t.getAttribute("data-lang"),name:t.getAttribute("data-name"),invisible:t.getAttribute("data-invisible"),container:t}),t.removeAttribute("data-captcha");var e=document.querySelector("[data-name=captcha-page]");e&&window.$ite.captcha.status.smart_captcha!==r.STATUS_LOADED&&e.click()}},t.prototype.addCaptcha=function(e){var i;try{var a=e.container,r=e.sitekey,o=e.type,s=e.rsize,l=e.theme,c=e.invisible,d=e.name,u={sitekey:r,type:o,rsize:s,theme:l,invisible:c};"captcha-page"===d?(u.callback=this.onSubmit.bind(this),u.invisible=!1,$(a).data(n,window.smartCaptcha.render(e.container,u))):(null===(i=this.getButton())||void 0===i||i.addEventListener("click",this.sendCaptcha),this.form.querySelectorAll("input, textarea, select").forEach((function(e){e.addEventListener("focus",t.onFocusin),e.addEventListener("blur",t.onFocusout)})),a.remove()),this.form.insertAdjacentHTML("beforeend",'<textarea name="smart-token" style="display: none !important;"></textarea>'),$(a).data("captcha-init",1)}catch(t){console.error("Error: ",t)}},t.prototype.onSubmit=function(e){var i,a=this.form.querySelector('[name="smart-token"]');if(a&&a.insertAdjacentHTML("afterbegin",e),window.$ite.captcha.ajax_force)-1!==window.$ite.captcha.ajax_data[1][0].indexOf("&smart-token=&")&&(window.$ite.captcha.ajax_data[1][0]=window.$ite.captcha.ajax_data[1][0].replace("&smart-token=&","&smart-token=".concat(e,"&"))),-1===window.$ite.captcha.ajax_data[1][0].indexOf("&smart-token=&")&&!0===window.$ite.captcha.ajax_data[1][0].endsWith("&smart-token=")&&(window.$ite.captcha.ajax_data[1][0]+=e),-1===window.$ite.captcha.ajax_data[1][0].indexOf("&smart-token=&")&&-1===window.$ite.captcha.ajax_data[1][0].indexOf("&smart-token=")&&(window.$ite.captcha.ajax_data[1][0]+="&smart-token=".concat(e)),window.$ite.captcha.ajax_force=!1,window.$ite.captcha.ajax.apply(window.$ite.captcha.ajax_data[0],window.$ite.captcha.ajax_data[1]),window.$ite.captcha.ajax_data=[];else try{this.send(),null===(i=this.getButton())||void 0===i||i.removeEventListener("click",this.sendCaptcha)}catch(t){console.error(t)}var n=document.querySelector(".SmartCaptcha-Shield");n&&(n.style.visibility="hidden"),this.unsubscribe&&this.unsubscribe();var r=t.getBadge();r&&window.smartCaptcha.reset(r)},t.onFocusin=function(){var t=document.querySelector(".SmartCaptcha-Shield");t&&(t.style.visibility="visible")},t.onFocusout=function(){var t=document.querySelector(".SmartCaptcha-Shield");t&&(t.style.visibility="hidden")},t.getBadge=function(){return $("#".concat(a)).data(n)},t.prototype.getButton=function(){return this.form.querySelector("button")},t.prototype.execute=function(e){var i=this;window.$ite.captcha.isRendered||window.$ite.captcha.render("smart_captcha");var a=t.getBadge();return a||(this.unsubscribe=window.smartCaptcha.subscribe(a,"success",(function(t){return i.onSubmit(t)})),window.smartCaptcha.execute(a)),e.preventDefault(),e.stopPropagation(),!1},t.prototype.init=function(){var t=this;setInterval((function(){try{t.checker()}catch(t){console.error("Captcha checker:",t)}}),300)},t.prototype.start=function(){var t,e=this;window.addEventListener("SmartCaptchaLoaded",(function(){e.init()})),(null===(t=window.$ite)||void 0===t?void 0:t.captcha.status.smart_captcha)===r.STATUS_NOT_LOADED&&this.load()},t}();var l=function(){var t;return(null===(t=window.$ite)||void 0===t?void 0:t.captcha.activeType)===o}},8610:(t,e,i)=>{i.d(e,{$U:()=>a,Ay:()=>s,QF:()=>n,Yb:()=>o});var a,n="screen",r=["(min-width: 1920px)","(min-width: 1440px)","(min-width: 1280px)",n,"(max-width: 991px)","(max-width: 767px)","(max-width: 479px)"],o=r.indexOf(n);!function(t){t.BIG_SCREEN3=0,t.BIG_SCREEN2=1,t.BIG_SCREEN1=2,t.SCREEN=3,t.TABLET_LANDSCAPE=4,t.TABLET_PORTRAIT=5,t.MOBILE=6}(a||(a={}));const s=r}}]);